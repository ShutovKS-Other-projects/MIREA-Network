#C-iBGP-102
en
conf t
hostname KShutov-C-iBGP-102

int e0/0
description "KShutov-Main-Router"
ip address 16.34.1.2 255.255.255.252
no shutdown

int e0/1
description "KShutov-M-OSPF-10"
ip address 15.34.1.1 255.255.255.252
no shutdown

int e0/2
description "KShutov-C-iBGP-15"
ip address 13.34.1.102 255.255.255.0
no shutdown

int e0/3
description "KShutov-M-iBGP-101"
ip address 13.34.2.102 255.255.255.0
no shutdown

int e1/0
description "KShutov-C-iBGP-28"
ip address 13.34.3.102 255.255.255.0
no shutdown

exit

router bgp 400
network 13.34.1.0 mask 255.255.255.0
network 13.34.2.0 mask 255.255.255.0
network 13.34.3.0 mask 255.255.255.0
network 16.34.1.0 mask 255.255.255.252
network 15.34.1.0 mask 255.255.255.252
neighbor 13.34.1.15 remote-as 400
neighbor 13.34.2.101 remote-as 400
neighbor 13.34.3.28 remote-as 400
neighbor 13.34.1.15 next-hop-self
neighbor 13.34.2.101 next-hop-self
neighbor 13.34.3.28 next-hop-self
neighbor 13.34.1.15 route-reflector-client
neighbor 13.34.2.101 route-reflector-client
neighbor 13.34.3.28 route-reflector-client
redistribute connected
neighbor 16.34.1.1 remote-as 100
neighbor 15.34.1.2 remote-as 300
default-metric 1

exit
exit 
wr

#M-iBGP-101
/system identity
set name=KShutov-M-iBGP-101

/interface bridge
add name=loopback0

/interface wireless security-profiles
set [ find default=yes ] supplicant-identity=MikroTik

/ip address
add interface=ether1 address=13.34.2.101/24 disable=no comment=KShutov-C-iBGP-102 network=13.34.2.0
add interface=ether2 address=13.34.6.101/24 disable=no comment=KShutov-C-iBGP-28 network=13.34.6.0
add interface=ether3 address=13.34.5.101/24 disable=no comment=KShutov-C-iBGP-15 network=13.34.5.0
add interface=ether4 address=13.34.8.101/24 disable=no comment=KShutov-C-iBGP-23 network=13.34.8.0
add interface=ether5 address=13.34.9.101/24 disable=no comment=KShutov-C-iBGP-33 network=13.34.9.0
add interface=loopback0 address=9.34.9.9/24 disabled=no network=9.34.9.9

/routing bgp instance
add as=400 name=BGP400 redistribute-connected=yes router-id=9.34.9.9

/routing bgp network
add network=13.34.2.0/24
add network=13.34.5.0/24
add network=13.34.8.0/24
add network=13.34.9.0/24
add network=13.34.6.0/24
add network=9.34.9.9/32

/routing bgp peer
add name=peer1 remote-address=13.34.2.102 remote-as=400 instance=BGP400 route-reflect=yes
add name=peer2 remote-address=13.34.6.28 remote-as=400 instance=BGP400 route-reflect=yes
add name=peer3 remote-address=13.34.5.15 remote-as=400 instance=BGP400 route-reflect=yes
add name=peer4 remote-address=13.34.8.23 remote-as=400 instance=BGP400 route-reflect=yes
add name=peer5 remote-address=13.34.9.33 remote-as=400 instance=BGP400 route-reflect=yes

/ip dhcp-client
remove number=0
..
..

#C-iBGP-15
en
conf t
hostname KShutov-C-iBGP-15

int e0/0
description "KShutov-C-iBGP-102"
ip address 13.34.1.15 255.255.255.0
no shutdown

int e0/2
description "KShutov-C-iBGP-23"
ip address 13.34.4.15 255.255.255.0
no shutdown

int e0/3
description "KShutov-M-iBGP-101"
ip address 13.34.5.15 255.255.255.0
no shutdown

exit

router bgp 400
network 13.34.1.0 mask 255.255.255.0
network 13.34.5.0 mask 255.255.255.0
network 13.34.4.0 mask 255.255.255.0
neighbor 13.34.1.102 remote-as 400
neighbor 13.34.5.101 remote-as 400
neighbor 13.34.4.23 remote-as 400

neighbor 13.34.1.102 next-hop-self
neighbor 13.34.5.101 next-hop-self
neighbor 13.34.4.23 next-hop-self

exit
exit 
wr

#C-iBGP-28
en
conf t
hostname KShutov-C-iBGP-28

int e0/1
description "KShutov-C-iBGP-102"
ip address 13.34.3.28 255.255.255.0
no shutdown

int e0/2
description "KShutov-C-iBGP-33"
ip address 13.34.7.28 255.255.255.0
no shutdown

int e0/3
description "KShutov-M-iBGP-101"
ip address 13.34.6.28 255.255.255.0
no shutdown

exit

router bgp 400
network 13.34.3.0 mask 255.255.255.0
network 13.34.6.0 mask 255.255.255.0
network 13.34.7.0 mask 255.255.255.0
neighbor 13.34.3.102 remote-as 400
neighbor 13.34.6.101 remote-as 400
neighbor 13.34.7.33 remote-as 400

neighbor 13.34.3.102 next-hop-self
neighbor 13.34.6.101 next-hop-self
neighbor 13.34.7.33 next-hop-self

exit
exit 
wr

#C-iBGP-33
en
conf t
hostname KShutov-C-iBGP-33

int e0/0
description "KShutov-C-iBGP-28"
ip address 13.34.7.33 255.255.255.0
no shutdown

int e0/1
description "KShutov-C-iBGP-23"
ip address 13.34.10.33 255.255.255.0
no shutdown

int e0/2
description "KShutov-M-iBGP-101"
ip address 13.34.9.33 255.255.255.0
no shutdown

exit

router bgp 400
network 13.34.7.0 mask 255.255.255.0
network 13.34.9.0 mask 255.255.255.0
network 13.34.10.0 mask 255.255.255.0
neighbor 13.34.7.28 remote-as 400
neighbor 13.34.9.101 remote-as 400
neighbor 13.34.10.23 remote-as 400

neighbor 13.34.7.28 next-hop-self
neighbor 13.34.9.101 next-hop-self
neighbor 13.34.10.23 next-hop-self

exit
exit 
wr

#C-iBGP-23
en
conf t
hostname KShutov-C-iBGP-23

int e0/0
description "KShutov-C-iBGP-15"
ip address 13.34.4.23 255.255.255.0
no shutdown

int e0/1
description "KShutov-C-iBGP-33"
ip address 13.34.10.23 255.255.255.0
no shutdown

int e0/2
description "KShutov-M-iBGP-101"
ip address 13.34.8.23 255.255.255.0
no shutdown

exit

router bgp 400
network 13.34.4.0 mask 255.255.255.0
network 13.34.8.0 mask 255.255.255.0
network 13.34.10.0 mask 255.255.255.0
neighbor 13.34.4.15 remote-as 400
neighbor 13.34.8.101 remote-as 400
neighbor 13.34.10.33 remote-as 400

neighbor 13.34.4.15 next-hop-self
neighbor 13.34.8.101 next-hop-self
neighbor 13.34.10.33 next-hop-self

neighbor 13.34.4.15 route-reflector-client
neighbor 13.34.8.101 route-reflector-client
neighbor 13.34.10.33 route-reflector-client

exit
exit 
wr
